
## Lateral Structure Mass Divergence

```{r lat-struc-mass-div, echo = FALSE}
# expects parameters file1, file2, type1, type2
lsmd1 = read_lsmd(file1, type1, grain.classes, grain.rows)
lsmd2 = read_lsmd(file2, type2, grain.classes, grain.rows)
lsmd.diff = diff_lsmd(lsmd1, lsmd2)
lsmd.rmse.time = rmse_lsmd(lsmd.diff, "Time")

lsmd.diff %>%
  mutate(Station = as.numeric(str_extract(Station, "[0-9]+"))) %>%
  ggplot() + plot.theme +
  aes(x = Station, y = diff_lsmd, color = GrainClass) + geom_line() +
  ylab("Difference") +
  ggtitle("Lateral Structure Mass Divergence Differences at Stations") +
  facet_wrap( ~ Time)
lsmd.diff %>% ggplot() + plot.theme +
  aes(x = Time, y = diff_lsmd, fill = GrainClass) +
  geom_boxplot() + facet_wrap( ~ GrainClass) +
  ylab("Difference") +
  ggtitle("Lateral Structure Mass Divergence Differences")
lsmd.rmse.time %>% ggplot() + plot.theme +
  aes(x = GrainClass, y = rmse_lsmd, fill = GrainClass) +
  geom_col(color = "black") + ylab("RMSE") +
  facet_wrap( ~ factor(Time, levels = rev(sort(unique(Time))))) + 
  ggtitle("Lateral Structure Mass Divergence RMSE by Grain Class")
```


